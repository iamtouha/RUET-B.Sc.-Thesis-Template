\documentclass[12pt, a4paper, final]{report}
\usepackage[T1]{fontenc}
\usepackage{fontspec}
\usepackage{graphicx} % Required for inserting images
\usepackage[left=3cm, top=2.54cm, right=2.54cm]{geometry}
\usepackage[hidelinks]{hyperref}
\usepackage{setspace}
\usepackage{multicol}
\usepackage{tabularx} 
\usepackage{titlesec}
\usepackage{tocloft} 
\usepackage{caption} 
\usepackage{subcaption} 
\usepackage{setspace}
\usepackage{afterpage}
\usepackage{float}
\usepackage{parskip}
\usepackage{subfiles}

% variables: to be filled
\newcommand{\thesisTitle}{Thesis Title}
\newcommand{\submissionDate}{October 2023}
% Authors
\newcommand{\authorA}{Author A}
\newcommand{\authorARoll}{1702***}
\newcommand{\authorB}{Author B}
\newcommand{\authorBRoll}{1702***}
% Supervisor
\newcommand{\supervisor}{Supervisor Name}
\newcommand{\supervisorDesignation}{Supervisor Designation}
% External
\newcommand{\external}{External Name}
\newcommand{\externalDesignation}{External Designation}
\newcommand{\externalDept}{Department of Mechaincal Engineering}
\newcommand{\externalUni}{Rajshahi University of Engineering \& Technology}
% Department Head
\newcommand{\deptHead}{Dept. Head Name} 

% Definitons
\newcommand{\dept}{Department of Mechaincal Engineering}
\newcommand{\ruet}{Rajshahi University of Engineering \& Technology}
\newcommand{\ruetBD}{Rajshahi University of Engineering \& Technology, Bangladesh}
\newcommand{\tagline}{Heavenâ€™s light is our guide}

% chapter headings
\renewcommand\thechapter{\arabic{chapter}}

% Customize chapter headings
\titleformat{\chapter}[display]
  {\centering\fontsize{16}{16}\selectfont\bfseries}
  {Chapter \thechapter}
  {0em}
  {\vspace{0.3\baselineskip}}

% Customize section headings
\titlespacing{\section}{0pt}{1.5\baselineskip}{0.7\baselineskip}
\titleformat{\section}[hang]
  {\fontsize{13}{13}\selectfont\bfseries}
  {\thesection}
  {0.5em}
  {}
  
  
% Customize subsection headings
\titleformat{\subsection}[hang]
  {\fontsize{12}{1em}\selectfont\bfseries}
  {\thesubsection}
  {0.5em}
  {}

%table of contents format
\setlength{\cftsecindent}{64pt} 
\setlength{\cftchapindent}{15pt} 
\setlength{\cftsubsecindent}{95pt}  
\setlength{\cftchapnumwidth}{45pt}  
\setlength{\cftbeforetoctitleskip}{0pt}
\renewcommand{\cftsecleader}{\hfill}
\renewcommand{\cftsubsecleader}{\hfill}
\renewcommand{\cftchapfont}{\bfseries \fontsize{12pt}{1pt} \selectfont }
\renewcommand{\cftchappagefont}{\normalfont}
\renewcommand{\contentsname}{\hfill\bfseries\Large List of contents \hfill}   
\renewcommand{\cftaftertoctitle}{\hfill}

\addtocontents{toc}{\protect\contentsline{chapter}{\hspace{-15pt}Chapter\hspace{15pt}Title}{\bfseries Page No.\hspace{-15pt}}{}}
\addtocontents{toc}{\protect\vspace*{0.5\baselineskip}}

 % List of Figures format
 \setlength{\cftfignumwidth}{50pt}
\cftsetindents{figure}{0em}{4.4em}  
\renewcommand{\cftloftitlefont}{\hfill\bfseries \fontsize{16pt}{1pt} \selectfont}
\renewcommand{\cftafterloftitle}{\hfill}
\renewcommand{\cftfigdotsep}{\cftnodots}

\addtocontents{lof}{\protect\contentsline{table}{\bfseries\hspace{-20pt}Figure No.\hspace{15pt}Title}{\bfseries Page No.\hspace{-15pt}}{}}
\addtocontents{lof}{\protect\vspace*{0.5\baselineskip}}

 % List of Tables format
\setlength{\cfttabnumwidth}{52pt}
\cftsetindents{table}{0em}{4em}  
\renewcommand{\listtablename}{ List of tables }   
\renewcommand{\cftlottitlefont}{\hfill\bfseries \fontsize{16pt}{1pt} \selectfont}
\renewcommand{\cftafterlottitle}{\hfill}
\renewcommand{\cfttabdotsep}{\cftnodots}

\addtocontents{lot}{\protect\contentsline{table}{\bfseries\hspace{-15pt}Table No.\hspace{15pt}Title}{\bfseries Page No.\hspace{-15pt}}{}}
\addtocontents{lot}{\protect\vspace*{0.5\baselineskip}}
 
% import Font for ruet tagline - heaven's light is our guide.
\newfontfamily\monocorsiva[Path=fonts/]{Monotype-Corsiva.ttf}
\setmainfont{Times New Roman}
\setlength{\parindent}{0pt}

% Spacing after table caption
\captionsetup[table]{skip=1em}

\hypersetup
{
    pdfauthor={\authorA, \authorB},
    pdfsubject={BSc Thesis},
    pdftitle={\thesisTitle~~- BSc Thesis by\authorA~~and \authorB},
    pdfkeywords={RUET, Thesis, Report, \dept}
}


\begin{document}

\pagenumbering{roman}
\subfile{cover.tex}

\newpage
\subfile{fulfilment.tex}

\newpage
\subfile{chapters/i_certificate.tex}

\newpage
\subfile{chapters/ii_acknowledgment.tex}

\newpage
\subfile{chapters/iii_abstract.tex}

\newpage
\addcontentsline{toc}{section}{List of contents}
\tableofcontents

\newpage
\addcontentsline{toc}{section}{List of figures}
\listoffigures

\newpage
\subfile{chapters/abbreviations.tex}

\newpage
\addcontentsline{toc}{section}{List of tables}
\listoftables

\clearpage
\pagenumbering{arabic}

\setstretch{1.15} % Adjust line spacing to 1.15


\newpage
\subfile{chapters/1_introduction.tex}

\newpage
\subfile{chapters/2_literature-review.tex}

\newpage
\subfile{chapters/3_methodology.tex}

\newpage
\subfile{chapters/4_results-and-discussions.tex}

\newpage
\subfile{chapters/5_conclusion.tex}

\newpage
\addcontentsline{toc}{chapter}{\hspace{42pt} References}
\renewcommand\bibname{References}
\bibliographystyle{ieeetr}
\bibliography{bibliography.bib}

\appendix

% Customize appendix chapter headings
\titleformat{\chapter}[display]
  {\centering\fontsize{16}{16}\selectfont\bfseries}
  {\vspace{-1\baselineskip}}
  {0em}
  {\vspace{0.3\baselineskip}}

\subfile{chapters/appendix.tex}

\end{document}
